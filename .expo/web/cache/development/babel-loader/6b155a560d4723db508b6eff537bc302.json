{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _extends from \"@babel/runtime/helpers/extends\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\n\nimport { __awaiter, __rest } from \"tslib\";\nimport { Audio, Video } from 'expo-av';\nimport ActivityIndicator from \"react-native-web/dist/exports/ActivityIndicator\";\nimport Animated from \"react-native-web/dist/exports/Animated\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport TouchableWithoutFeedback from \"react-native-web/dist/exports/TouchableWithoutFeedback\";\nimport View from \"react-native-web/dist/exports/View\";\nimport { ControlStates, ErrorSeverity, PlaybackStates } from \"./constants\";\nimport { ErrorMessage, TouchableButton, deepMerge, getMinutesSecondsFromMilliseconds, styles } from \"./utils\";\nimport { MaterialIcons } from '@expo/vector-icons';\nimport { defaultProps } from \"./props\";\nimport { useEffect, useRef, useState } from 'react';\nimport React from 'react';\nimport Slider from '@react-native-community/slider';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\n\nvar VideoPlayer = function VideoPlayer(tempProps) {\n  var props = deepMerge(defaultProps, tempProps);\n  var playbackInstance = null;\n  var controlsTimer = null;\n  var initialShow = props.defaultControlsVisible;\n  var header = props.header;\n\n  var _useState = useState(''),\n      _useState2 = _slicedToArray(_useState, 2),\n      errorMessage = _useState2[0],\n      setErrorMessage = _useState2[1];\n\n  var controlsOpacity = useRef(new Animated.Value(props.defaultControlsVisible ? 1 : 0)).current;\n\n  var _useState3 = useState(props.defaultControlsVisible ? ControlStates.Visible : ControlStates.Hidden),\n      _useState4 = _slicedToArray(_useState3, 2),\n      controlsState = _useState4[0],\n      setControlsState = _useState4[1];\n\n  var _useState5 = useState({\n    position: 0,\n    duration: 0,\n    state: props.videoProps.source ? PlaybackStates.Loading : PlaybackStates.Error\n  }),\n      _useState6 = _slicedToArray(_useState5, 2),\n      playbackInstanceInfo = _useState6[0],\n      setPlaybackInstanceInfo = _useState6[1];\n\n  var _a = props.slider,\n      sliderRef = _a.ref,\n      sliderProps = __rest(_a, [\"ref\"]);\n\n  var screenRatio = props.style.width / props.style.height;\n  var videoHeight = props.style.height;\n  var videoWidth = videoHeight * screenRatio;\n\n  if (videoWidth > props.style.width) {\n    videoWidth = props.style.width;\n    videoHeight = videoWidth / screenRatio;\n  }\n\n  useEffect(function () {\n    setAudio();\n    return function () {\n      if (playbackInstance) {\n        playbackInstance.setStatusAsync({\n          shouldPlay: false\n        });\n      }\n    };\n  }, []);\n  useEffect(function () {\n    if (!props.videoProps.source) {\n      console.error('[VideoPlayer] `Source` is a required in `videoProps`. ' + 'Check https://docs.expo.io/versions/latest/sdk/video/#usage');\n      setErrorMessage('`Source` is a required in `videoProps`');\n      setPlaybackInstanceInfo(_extends(_extends({}, playbackInstanceInfo), {\n        state: PlaybackStates.Error\n      }));\n    } else {\n      setPlaybackInstanceInfo(_extends(_extends({}, playbackInstanceInfo), {\n        state: PlaybackStates.Playing\n      }));\n    }\n  }, [props.videoProps.source]);\n\n  var hideAnimation = function hideAnimation() {\n    Animated.timing(controlsOpacity, {\n      toValue: 0,\n      duration: props.animation.fadeOutDuration,\n      useNativeDriver: true\n    }).start(function (_ref) {\n      var finished = _ref.finished;\n\n      if (finished) {\n        setControlsState(ControlStates.Hidden);\n      }\n    });\n  };\n\n  var animationToggle = function animationToggle() {\n    if (controlsState === ControlStates.Hidden) {\n      Animated.timing(controlsOpacity, {\n        toValue: 1,\n        duration: props.animation.fadeInDuration,\n        useNativeDriver: true\n      }).start(function (_ref2) {\n        var finished = _ref2.finished;\n\n        if (finished) {\n          setControlsState(ControlStates.Visible);\n        }\n      });\n    } else if (controlsState === ControlStates.Visible) {\n      hideAnimation();\n    }\n\n    if (controlsTimer === null && props.autoHidePlayer) {\n      controlsTimer = setTimeout(function () {\n        if (playbackInstanceInfo.state === PlaybackStates.Playing && controlsState === ControlStates.Hidden) {\n          hideAnimation();\n        }\n\n        if (controlsTimer) {\n          clearTimeout(controlsTimer);\n        }\n\n        controlsTimer = null;\n      }, 2000);\n    }\n  };\n\n  var setAudio = function setAudio() {\n    return __awaiter(void 0, void 0, void 0, _regeneratorRuntime.mark(function _callee() {\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n              _context.next = 3;\n              return Audio.setAudioModeAsync({\n                playsInSilentModeIOS: true\n              });\n\n            case 3:\n              _context.next = 8;\n              break;\n\n            case 5:\n              _context.prev = 5;\n              _context.t0 = _context[\"catch\"](0);\n              props.errorCallback({\n                type: ErrorSeverity.NonFatal,\n                message: 'Audio.setAudioModeAsync',\n                obj: _context.t0\n              });\n\n            case 8:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[0, 5]]);\n    }));\n  };\n\n  var updatePlaybackCallback = function updatePlaybackCallback(status) {\n    props.playbackCallback(status);\n\n    if (status.isLoaded) {\n      setPlaybackInstanceInfo(_extends(_extends({}, playbackInstanceInfo), {\n        position: status.positionMillis,\n        duration: status.durationMillis || 0,\n        state: status.positionMillis === status.durationMillis ? PlaybackStates.Ended : status.isBuffering ? PlaybackStates.Buffering : status.shouldPlay ? PlaybackStates.Playing : PlaybackStates.Paused\n      }));\n\n      if (status.didJustFinish && controlsState === ControlStates.Hidden || status.isBuffering && controlsState === ControlStates.Hidden && initialShow) {\n        animationToggle();\n        initialShow = false;\n      }\n    } else {\n      if (status.isLoaded === false && status.error) {\n        var errorMsg = \"Encountered a fatal error during playback: \" + status.error;\n        setErrorMessage(errorMsg);\n        props.errorCallback({\n          type: ErrorSeverity.Fatal,\n          message: errorMsg,\n          obj: {}\n        });\n      }\n    }\n  };\n\n  var togglePlay = function togglePlay() {\n    return __awaiter(void 0, void 0, void 0, _regeneratorRuntime.mark(function _callee2() {\n      var shouldPlay;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              if (!(controlsState === ControlStates.Hidden)) {\n                _context2.next = 2;\n                break;\n              }\n\n              return _context2.abrupt(\"return\");\n\n            case 2:\n              shouldPlay = playbackInstanceInfo.state !== PlaybackStates.Playing;\n\n              if (!(playbackInstance !== null)) {\n                _context2.next = 8;\n                break;\n              }\n\n              _context2.next = 6;\n              return playbackInstance.setStatusAsync(_extends({\n                shouldPlay: shouldPlay\n              }, playbackInstanceInfo.state === PlaybackStates.Ended && {\n                positionMillis: 0\n              }));\n\n            case 6:\n              setPlaybackInstanceInfo(_extends(_extends({}, playbackInstanceInfo), {\n                state: playbackInstanceInfo.state === PlaybackStates.Playing ? PlaybackStates.Paused : PlaybackStates.Playing\n              }));\n\n              if (shouldPlay) {\n                animationToggle();\n              }\n\n            case 8:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n  };\n\n  if (playbackInstanceInfo.state === PlaybackStates.Error) {\n    return _jsx(View, {\n      style: {\n        backgroundColor: props.style.videoBackgroundColor,\n        width: videoWidth,\n        height: videoHeight\n      },\n      children: _jsx(ErrorMessage, {\n        style: props.textStyle,\n        message: errorMessage\n      })\n    });\n  }\n\n  if (playbackInstanceInfo.state === PlaybackStates.Loading) {\n    return _jsx(View, {\n      style: {\n        backgroundColor: props.style.controlsBackgroundColor,\n        width: videoWidth,\n        height: videoHeight,\n        justifyContent: 'center'\n      },\n      children: props.icon.loading || _jsx(ActivityIndicator, _objectSpread({}, props.activityIndicator))\n    });\n  }\n\n  return _jsxs(View, {\n    style: {\n      backgroundColor: props.style.videoBackgroundColor,\n      width: videoWidth,\n      height: videoHeight,\n      maxWidth: '100%'\n    },\n    children: [_jsx(Video, _objectSpread({\n      style: styles.videoWrapper\n    }, props.videoProps, {\n      ref: function ref(component) {\n        playbackInstance = component;\n\n        if (props.videoProps.ref) {\n          props.videoProps.ref.current = component;\n        }\n      },\n      onPlaybackStatusUpdate: updatePlaybackCallback\n    })), _jsx(Animated.View, {\n      style: [styles.topInfoWrapper, {\n        opacity: controlsOpacity\n      }],\n      children: header\n    }), _jsx(TouchableWithoutFeedback, {\n      onPress: animationToggle,\n      children: _jsxs(Animated.View, {\n        style: _extends(_extends({}, StyleSheet.absoluteFillObject), {\n          opacity: controlsOpacity,\n          justifyContent: 'center',\n          alignItems: 'center'\n        }),\n        children: [_jsx(View, {\n          style: _extends(_extends({}, StyleSheet.absoluteFillObject), {\n            backgroundColor: props.style.controlsBackgroundColor,\n            opacity: 0.5\n          })\n        }), _jsx(View, {\n          pointerEvents: controlsState === ControlStates.Visible ? 'auto' : 'none',\n          children: _jsx(View, {\n            style: styles.iconWrapper,\n            children: _jsx(TouchableButton, {\n              onPress: togglePlay,\n              children: _jsxs(View, {\n                children: [playbackInstanceInfo.state === PlaybackStates.Buffering && (props.icon.loading || _jsx(ActivityIndicator, _objectSpread({}, props.activityIndicator))), playbackInstanceInfo.state === PlaybackStates.Playing && props.icon.pause, playbackInstanceInfo.state === PlaybackStates.Paused && props.icon.play, playbackInstanceInfo.state === PlaybackStates.Ended && props.icon.replay, (playbackInstanceInfo.state === PlaybackStates.Ended && !props.icon.replay || playbackInstanceInfo.state === PlaybackStates.Playing && !props.icon.pause || playbackInstanceInfo.state === PlaybackStates.Paused && !props.icon.pause) && _jsx(MaterialIcons, {\n                  name: playbackInstanceInfo.state === PlaybackStates.Playing ? 'pause' : playbackInstanceInfo.state === PlaybackStates.Paused ? 'play-arrow' : 'replay',\n                  style: props.icon.style,\n                  size: props.icon.size,\n                  color: props.icon.color\n                })]\n              })\n            })\n          })\n        })]\n      })\n    }), _jsxs(Animated.View, {\n      style: [styles.bottomInfoWrapper, {\n        opacity: controlsOpacity\n      }],\n      children: [props.timeVisible && _jsx(Text, {\n        style: [props.textStyle, styles.timeLeft],\n        children: getMinutesSecondsFromMilliseconds(playbackInstanceInfo.position)\n      }), props.slider.visible && _jsx(Slider, _objectSpread({}, sliderProps, {\n        style: [styles.slider, props.slider.style],\n        value: playbackInstanceInfo.duration ? playbackInstanceInfo.position / playbackInstanceInfo.duration : 0,\n        onSlidingStart: function onSlidingStart() {\n          if (playbackInstanceInfo.state === PlaybackStates.Playing) {\n            togglePlay();\n            setPlaybackInstanceInfo(_extends(_extends({}, playbackInstanceInfo), {\n              state: PlaybackStates.Paused\n            }));\n          }\n        },\n        onSlidingComplete: function onSlidingComplete(e) {\n          return __awaiter(void 0, void 0, void 0, _regeneratorRuntime.mark(function _callee3() {\n            var position;\n            return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n              while (1) {\n                switch (_context3.prev = _context3.next) {\n                  case 0:\n                    position = e * playbackInstanceInfo.duration;\n\n                    if (!playbackInstance) {\n                      _context3.next = 4;\n                      break;\n                    }\n\n                    _context3.next = 4;\n                    return playbackInstance.setStatusAsync({\n                      positionMillis: position,\n                      shouldPlay: true\n                    });\n\n                  case 4:\n                    setPlaybackInstanceInfo(_extends(_extends({}, playbackInstanceInfo), {\n                      position: position\n                    }));\n\n                  case 5:\n                  case \"end\":\n                    return _context3.stop();\n                }\n              }\n            }, _callee3);\n          }));\n        }\n      })), props.timeVisible && _jsx(Text, {\n        style: [props.textStyle, styles.timeRight],\n        children: getMinutesSecondsFromMilliseconds(playbackInstanceInfo.duration)\n      }), props.fullscreen.visible && _jsx(TouchableButton, {\n        onPress: function onPress() {\n          return props.fullscreen.inFullscreen ? props.fullscreen.exitFullscreen() : props.fullscreen.enterFullscreen();\n        },\n        children: _jsxs(View, {\n          children: [props.icon.fullscreen, props.icon.exitFullscreen, (!props.icon.fullscreen && props.fullscreen.inFullscreen || !props.icon.exitFullscreen && !props.fullscreen.inFullscreen) && _jsx(MaterialIcons, {\n            name: props.fullscreen.inFullscreen ? 'fullscreen-exit' : 'fullscreen',\n            style: props.icon.style,\n            size: props.icon.size / 2,\n            color: props.icon.color\n          })]\n        })\n      })]\n    })]\n  });\n};\n\nVideoPlayer.defaultProps = defaultProps;\nexport default VideoPlayer;","map":{"version":3,"sources":["E:/chrisholloway/flicknplayreacttv/node_modules/expo-video-player/dist/index.js"],"names":["__awaiter","__rest","Audio","Video","ControlStates","ErrorSeverity","PlaybackStates","ErrorMessage","TouchableButton","deepMerge","getMinutesSecondsFromMilliseconds","styles","MaterialIcons","defaultProps","useEffect","useRef","useState","React","Slider","VideoPlayer","tempProps","props","playbackInstance","controlsTimer","initialShow","defaultControlsVisible","header","errorMessage","setErrorMessage","controlsOpacity","Animated","Value","current","Visible","Hidden","controlsState","setControlsState","position","duration","state","videoProps","source","Loading","Error","playbackInstanceInfo","setPlaybackInstanceInfo","_a","slider","sliderRef","ref","sliderProps","screenRatio","style","width","height","videoHeight","videoWidth","setAudio","setStatusAsync","shouldPlay","console","error","Playing","hideAnimation","timing","toValue","animation","fadeOutDuration","useNativeDriver","start","finished","animationToggle","fadeInDuration","autoHidePlayer","setTimeout","clearTimeout","setAudioModeAsync","playsInSilentModeIOS","errorCallback","type","NonFatal","message","obj","updatePlaybackCallback","status","playbackCallback","isLoaded","positionMillis","durationMillis","Ended","isBuffering","Buffering","Paused","didJustFinish","errorMsg","Fatal","togglePlay","backgroundColor","videoBackgroundColor","textStyle","controlsBackgroundColor","justifyContent","icon","loading","activityIndicator","maxWidth","videoWrapper","component","topInfoWrapper","opacity","StyleSheet","absoluteFillObject","alignItems","iconWrapper","pause","play","replay","size","color","bottomInfoWrapper","timeVisible","timeLeft","visible","e","timeRight","fullscreen","inFullscreen","exitFullscreen","enterFullscreen"],"mappings":"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","sourcesContent":["import { __awaiter, __rest } from \"tslib\";\r\nimport { Audio, Video } from 'expo-av';\r\nimport { ActivityIndicator, Animated, StyleSheet, Text, TouchableWithoutFeedback, View, } from 'react-native';\r\nimport { ControlStates, ErrorSeverity, PlaybackStates } from './constants';\r\nimport { ErrorMessage, TouchableButton, deepMerge, getMinutesSecondsFromMilliseconds, styles, } from './utils';\r\nimport { MaterialIcons } from '@expo/vector-icons';\r\nimport { defaultProps } from './props';\r\nimport { useEffect, useRef, useState } from 'react';\r\nimport React from 'react';\r\nimport Slider from '@react-native-community/slider';\r\nconst VideoPlayer = (tempProps) => {\r\n    const props = deepMerge(defaultProps, tempProps);\r\n    let playbackInstance = null;\r\n    let controlsTimer = null;\r\n    let initialShow = props.defaultControlsVisible;\r\n    const header = props.header;\r\n    const [errorMessage, setErrorMessage] = useState('');\r\n    const controlsOpacity = useRef(new Animated.Value(props.defaultControlsVisible ? 1 : 0)).current;\r\n    const [controlsState, setControlsState] = useState(props.defaultControlsVisible ? ControlStates.Visible : ControlStates.Hidden);\r\n    const [playbackInstanceInfo, setPlaybackInstanceInfo] = useState({\r\n        position: 0,\r\n        duration: 0,\r\n        state: props.videoProps.source ? PlaybackStates.Loading : PlaybackStates.Error,\r\n    });\r\n    // We need to extract ref, because of misstypes in <Slider />\r\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\r\n    const _a = props.slider, { ref: sliderRef } = _a, sliderProps = __rest(_a, [\"ref\"]);\r\n    const screenRatio = props.style.width / props.style.height;\r\n    let videoHeight = props.style.height;\r\n    let videoWidth = videoHeight * screenRatio;\r\n    if (videoWidth > props.style.width) {\r\n        videoWidth = props.style.width;\r\n        videoHeight = videoWidth / screenRatio;\r\n    }\r\n    useEffect(() => {\r\n        setAudio();\r\n        return () => {\r\n            if (playbackInstance) {\r\n                playbackInstance.setStatusAsync({\r\n                    shouldPlay: false,\r\n                });\r\n            }\r\n        };\r\n    }, []);\r\n    useEffect(() => {\r\n        if (!props.videoProps.source) {\r\n            console.error('[VideoPlayer] `Source` is a required in `videoProps`. ' +\r\n                'Check https://docs.expo.io/versions/latest/sdk/video/#usage');\r\n            setErrorMessage('`Source` is a required in `videoProps`');\r\n            setPlaybackInstanceInfo(Object.assign(Object.assign({}, playbackInstanceInfo), { state: PlaybackStates.Error }));\r\n        }\r\n        else {\r\n            setPlaybackInstanceInfo(Object.assign(Object.assign({}, playbackInstanceInfo), { state: PlaybackStates.Playing }));\r\n        }\r\n    }, [props.videoProps.source]);\r\n    const hideAnimation = () => {\r\n        Animated.timing(controlsOpacity, {\r\n            toValue: 0,\r\n            duration: props.animation.fadeOutDuration,\r\n            useNativeDriver: true,\r\n        }).start(({ finished }) => {\r\n            if (finished) {\r\n                setControlsState(ControlStates.Hidden);\r\n            }\r\n        });\r\n    };\r\n    const animationToggle = () => {\r\n        if (controlsState === ControlStates.Hidden) {\r\n            Animated.timing(controlsOpacity, {\r\n                toValue: 1,\r\n                duration: props.animation.fadeInDuration,\r\n                useNativeDriver: true,\r\n            }).start(({ finished }) => {\r\n                if (finished) {\r\n                    setControlsState(ControlStates.Visible);\r\n                }\r\n            });\r\n        }\r\n        else if (controlsState === ControlStates.Visible) {\r\n            hideAnimation();\r\n        }\r\n        if (controlsTimer === null && props.autoHidePlayer) {\r\n            controlsTimer = setTimeout(() => {\r\n                if (playbackInstanceInfo.state === PlaybackStates.Playing &&\r\n                    controlsState === ControlStates.Hidden) {\r\n                    hideAnimation();\r\n                }\r\n                if (controlsTimer) {\r\n                    clearTimeout(controlsTimer);\r\n                }\r\n                controlsTimer = null;\r\n            }, 2000);\r\n        }\r\n    };\r\n    // Set audio mode to play even in silent mode (like the YouTube app)\r\n    const setAudio = () => __awaiter(void 0, void 0, void 0, function* () {\r\n        try {\r\n            yield Audio.setAudioModeAsync({\r\n                playsInSilentModeIOS: true,\r\n            });\r\n        }\r\n        catch (e) {\r\n            props.errorCallback({\r\n                type: ErrorSeverity.NonFatal,\r\n                message: 'Audio.setAudioModeAsync',\r\n                obj: e,\r\n            });\r\n        }\r\n    });\r\n    const updatePlaybackCallback = (status) => {\r\n        props.playbackCallback(status);\r\n        if (status.isLoaded) {\r\n            setPlaybackInstanceInfo(Object.assign(Object.assign({}, playbackInstanceInfo), { position: status.positionMillis, duration: status.durationMillis || 0, state: status.positionMillis === status.durationMillis\r\n                    ? PlaybackStates.Ended\r\n                    : status.isBuffering\r\n                        ? PlaybackStates.Buffering\r\n                        : status.shouldPlay\r\n                            ? PlaybackStates.Playing\r\n                            : PlaybackStates.Paused }));\r\n            if ((status.didJustFinish && controlsState === ControlStates.Hidden) ||\r\n                (status.isBuffering && controlsState === ControlStates.Hidden && initialShow)) {\r\n                animationToggle();\r\n                initialShow = false;\r\n            }\r\n        }\r\n        else {\r\n            if (status.isLoaded === false && status.error) {\r\n                const errorMsg = `Encountered a fatal error during playback: ${status.error}`;\r\n                setErrorMessage(errorMsg);\r\n                props.errorCallback({ type: ErrorSeverity.Fatal, message: errorMsg, obj: {} });\r\n            }\r\n        }\r\n    };\r\n    const togglePlay = () => __awaiter(void 0, void 0, void 0, function* () {\r\n        if (controlsState === ControlStates.Hidden) {\r\n            return;\r\n        }\r\n        const shouldPlay = playbackInstanceInfo.state !== PlaybackStates.Playing;\r\n        if (playbackInstance !== null) {\r\n            yield playbackInstance.setStatusAsync(Object.assign({ shouldPlay }, (playbackInstanceInfo.state === PlaybackStates.Ended && { positionMillis: 0 })));\r\n            setPlaybackInstanceInfo(Object.assign(Object.assign({}, playbackInstanceInfo), { state: playbackInstanceInfo.state === PlaybackStates.Playing\r\n                    ? PlaybackStates.Paused\r\n                    : PlaybackStates.Playing }));\r\n            if (shouldPlay) {\r\n                animationToggle();\r\n            }\r\n        }\r\n    });\r\n    if (playbackInstanceInfo.state === PlaybackStates.Error) {\r\n        return (<View style={{\r\n                backgroundColor: props.style.videoBackgroundColor,\r\n                width: videoWidth,\r\n                height: videoHeight,\r\n            }}>\r\n        <ErrorMessage style={props.textStyle} message={errorMessage}/>\r\n      </View>);\r\n    }\r\n    if (playbackInstanceInfo.state === PlaybackStates.Loading) {\r\n        return (<View style={{\r\n                backgroundColor: props.style.controlsBackgroundColor,\r\n                width: videoWidth,\r\n                height: videoHeight,\r\n                justifyContent: 'center',\r\n            }}>\r\n        {props.icon.loading || <ActivityIndicator {...props.activityIndicator}/>}\r\n      </View>);\r\n    }\r\n    return (<View style={{\r\n            backgroundColor: props.style.videoBackgroundColor,\r\n            width: videoWidth,\r\n            height: videoHeight,\r\n            maxWidth: '100%',\r\n        }}>\r\n      <Video style={styles.videoWrapper} {...props.videoProps} ref={component => {\r\n            playbackInstance = component;\r\n            if (props.videoProps.ref) {\r\n                props.videoProps.ref.current = component;\r\n            }\r\n        }} onPlaybackStatusUpdate={updatePlaybackCallback}/>\r\n\r\n      <Animated.View style={[\r\n            styles.topInfoWrapper,\r\n            {\r\n                opacity: controlsOpacity,\r\n            },\r\n        ]}>\r\n        {header}\r\n      </Animated.View>\r\n\r\n      <TouchableWithoutFeedback onPress={animationToggle}>\r\n        <Animated.View style={Object.assign(Object.assign({}, StyleSheet.absoluteFillObject), { opacity: controlsOpacity, justifyContent: 'center', alignItems: 'center' })}>\r\n          <View style={Object.assign(Object.assign({}, StyleSheet.absoluteFillObject), { backgroundColor: props.style.controlsBackgroundColor, opacity: 0.5 })}/>\r\n          <View pointerEvents={controlsState === ControlStates.Visible ? 'auto' : 'none'}>\r\n            <View style={styles.iconWrapper}>\r\n              <TouchableButton onPress={togglePlay}>\r\n                <View>\r\n                  {playbackInstanceInfo.state === PlaybackStates.Buffering &&\r\n            (props.icon.loading || <ActivityIndicator {...props.activityIndicator}/>)}\r\n                  {playbackInstanceInfo.state === PlaybackStates.Playing && props.icon.pause}\r\n                  {playbackInstanceInfo.state === PlaybackStates.Paused && props.icon.play}\r\n                  {playbackInstanceInfo.state === PlaybackStates.Ended && props.icon.replay}\r\n                  {((playbackInstanceInfo.state === PlaybackStates.Ended && !props.icon.replay) ||\r\n            (playbackInstanceInfo.state === PlaybackStates.Playing && !props.icon.pause) ||\r\n            (playbackInstanceInfo.state === PlaybackStates.Paused &&\r\n                !props.icon.pause)) && (<MaterialIcons name={playbackInstanceInfo.state === PlaybackStates.Playing\r\n                ? 'pause'\r\n                : playbackInstanceInfo.state === PlaybackStates.Paused\r\n                    ? 'play-arrow'\r\n                    : 'replay'} style={props.icon.style} size={props.icon.size} color={props.icon.color}/>)}\r\n                </View>\r\n              </TouchableButton>\r\n            </View>\r\n          </View>\r\n        </Animated.View>\r\n      </TouchableWithoutFeedback>\r\n\r\n      <Animated.View style={[\r\n            styles.bottomInfoWrapper,\r\n            {\r\n                opacity: controlsOpacity,\r\n            },\r\n        ]}>\r\n        {props.timeVisible && (<Text style={[props.textStyle, styles.timeLeft]}>\r\n            {getMinutesSecondsFromMilliseconds(playbackInstanceInfo.position)}\r\n          </Text>)}\r\n        {props.slider.visible && (<Slider {...sliderProps} style={[styles.slider, props.slider.style]} value={playbackInstanceInfo.duration\r\n                ? playbackInstanceInfo.position / playbackInstanceInfo.duration\r\n                : 0} onSlidingStart={() => {\r\n                if (playbackInstanceInfo.state === PlaybackStates.Playing) {\r\n                    togglePlay();\r\n                    setPlaybackInstanceInfo(Object.assign(Object.assign({}, playbackInstanceInfo), { state: PlaybackStates.Paused }));\r\n                }\r\n            }} onSlidingComplete={(e) => __awaiter(void 0, void 0, void 0, function* () {\r\n                const position = e * playbackInstanceInfo.duration;\r\n                if (playbackInstance) {\r\n                    yield playbackInstance.setStatusAsync({\r\n                        positionMillis: position,\r\n                        shouldPlay: true,\r\n                    });\r\n                }\r\n                setPlaybackInstanceInfo(Object.assign(Object.assign({}, playbackInstanceInfo), { position }));\r\n            })}/>)}\r\n        {props.timeVisible && (<Text style={[props.textStyle, styles.timeRight]}>\r\n            {getMinutesSecondsFromMilliseconds(playbackInstanceInfo.duration)}\r\n          </Text>)}\r\n        {props.fullscreen.visible && (<TouchableButton onPress={() => props.fullscreen.inFullscreen\r\n                ? props.fullscreen.exitFullscreen()\r\n                : props.fullscreen.enterFullscreen()}>\r\n            <View>\r\n              {props.icon.fullscreen}\r\n              {props.icon.exitFullscreen}\r\n              {((!props.icon.fullscreen && props.fullscreen.inFullscreen) ||\r\n                (!props.icon.exitFullscreen && !props.fullscreen.inFullscreen)) && (<MaterialIcons name={props.fullscreen.inFullscreen ? 'fullscreen-exit' : 'fullscreen'} style={props.icon.style} size={props.icon.size / 2} color={props.icon.color}/>)}\r\n            </View>\r\n          </TouchableButton>)}\r\n      </Animated.View>\r\n    </View>);\r\n};\r\nVideoPlayer.defaultProps = defaultProps;\r\nexport default VideoPlayer;\r\n"]},"metadata":{},"sourceType":"module"}